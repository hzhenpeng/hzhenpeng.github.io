<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title></title>
      <url>/2018/02/08/hzp/</url>
      <content type="html"><![CDATA[<p>站点自从开启 https 之后 ，百度分享就不能用了！但是又寻找不到类似百度分享的替代品。。</p>
<p>怎么办呢？要如何解决 百度分享不支持https的问题呢，</p>
<p>跟着博主动动手，让你百度分享仍然能在https下使用 ~</p>
<p>伸手党<br>先上伸手党的解决方案~</p>
<p>博主修改好的分享代码(下面两个链接下载其中一个)的即可</p>
<p>Github地址（推荐，2016.10.2更新）：<a href="https://github.com/hrwhisper/baiduShare" target="_blank" rel="noopener">https://github.com/hrwhisper/baiduShare</a><br>PS: 求点star！鼓励一下博主！<br>旧版本，不再更新。 备用地址： <a href="http://pan.baidu.com/s/1i4c1hnn" target="_blank" rel="noopener">http://pan.baidu.com/s/1i4c1hnn</a> 密码：0kjw<br>下载<br>下载方式如下：</p>
<p>github download method</p>
<p>使用方法<br>static 解压后丢到站点的根目录</p>
<p>这里需要确保要确保“根目录”能被访问到，比如我的wordpress确实就是丢到根目录即可<br>其它的比如hexo其实时放在public目录下，如果不行可以在配置文件中添加如下内容，禁止hexo编译static文件夹<br>skip_render:<br>– static/**<br>然后对应的百度分享代码中，把<a href="http://bdimg.share.baidu.com/改为" target="_blank" rel="noopener">http://bdimg.share.baidu.com/改为</a> /</p>
<p>.src=’<a href="http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion=&#39;+~(-new" target="_blank" rel="noopener">http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion=&#39;+~(-new</a> Date()/36e5)];<br>改为<br>.src=’/static/api/js/share.js?v=89860593.js?’];<br>1<br>2<br>3<br>.src=’<a href="http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion=&#39;+~(-new" target="_blank" rel="noopener">http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion=&#39;+~(-new</a> Date()/36e5)];<br>改为<br>.src=’/static/api/js/share.js?v=89860593.js?’];<br>比如说博主调用的百度分享代码如下：</p>
<p><div class="bdsharebuttonbox"><a href="#" class="bds_more" data-cmd="more"></a><a href="#" class="bds_fbook" data-cmd="fbook" title="分享到Facebook"></a><a href="#" class="bds_twi" data-cmd="twi" title="分享到Twitter"></a><a href="#" class="bds_linkedin" data-cmd="linkedin" title="分享到linkedin"></a><a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a><a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a><a href="#" class="bds_douban" data-cmd="douban" title="分享到豆瓣网"></a><a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a><a href="#" class="bds_evernotecn" data-cmd="evernotecn" title="分享到印象笔记"></a></div></p>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"1","bdSize":"24"},"share":{},"image":{"viewList":["fbook","twi","linkedin","qzone","tsina","douban","weixin","evernotecn"],"viewText":"分享到：","viewSize":"16"}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/static/api/js/share.js?v=89860593.js?'];</script>
1
2
<div class="bdsharebuttonbox"><a href="#" class="bds_more" data-cmd="more"></a><a href="#" class="bds_fbook" data-cmd="fbook" title="分享到Facebook"></a><a href="#" class="bds_twi" data-cmd="twi" title="分享到Twitter"></a><a href="#" class="bds_linkedin" data-cmd="linkedin" title="分享到linkedin"></a><a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a><a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a><a href="#" class="bds_douban" data-cmd="douban" title="分享到豆瓣网"></a><a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a><a href="#" class="bds_evernotecn" data-cmd="evernotecn" title="分享到印象笔记"></a></div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"1","bdSize":"24"},"share":{},"image":{"viewList":["fbook","twi","linkedin","qzone","tsina","douban","weixin","evernotecn"],"viewText":"分享到：","viewSize":"16"}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/static/api/js/share.js?v=89860593.js?'];</script>




<p>自己动手，丰衣足食<br>所谓授人以鱼不如授人以渔，博主把主要的修复过程记录如下:</p>
<p>获取百度分享的文件<br>你可以直接用chrome – F12 – source 查看有什么文件，然后保存（注意微信的需要先点一下，对应的 css 才会出来）</p>
<p>baidu-share-download</p>
<p>也可以直接看博主分享的文件，对应着下载。</p>
<p>把域名改成<a href="http://bdimg.share.baidu.com/加上对应的路径即可" target="_blank" rel="noopener">http://bdimg.share.baidu.com/加上对应的路径即可</a></p>
<p>修改一些文件<br>直接这么丢上去是会有问题的，你地址栏绿色的小锁会消失 T^T</p>
<p>就是说你虽然是Https的站点，但请求了http的资源，这种混合模式是不好滴</p>
<p>修复方法：</p>
<p>static\api\js\share.js<br>domain: {staticUrl: “<a href="http://bdimg.share.baidu.com/”}" target="_blank" rel="noopener">http://bdimg.share.baidu.com/”}</a> 修改为 domain: {staticUrl: “/”}<br>nsClick: “<a href="http://nsclick.baidu.com/v.gif”" target="_blank" rel="noopener">http://nsclick.baidu.com/v.gif”</a>  修改为  nsClick: “/”,<br>static\api\js\trans\logger.js<br>把里面的内容都删掉，但保留这个空文件<br>貌似就是这两个步骤，博主应该没漏掉</p>
<p>修改印象笔记图标<br>博主用的是主题1（明显比主题0好看啊，主题0还没印象笔记图标），</p>
<p>但是由于下面那个更多用的是主题0的图片，会造成加载两个图片，让我微微不爽（同样的没有印象笔记图标！）</p>
<p>于是修改如下：</p>
<p>static\api\css\share_popup.css<br>最后加上 .popup_evernotecn{background-position:4px -3190px;}<br>static\api\css\share_style0_16.css<br>最后加上 .bds_evernotecn{background-position:0 -3195px}<br>把 icons_1_16.png 重命名为 icons_0_16.png<br>可选：用tinypng 把图片压缩下，博主现在这个图片就7.81KB<br>微信URL过长失败二维码出不来的问题<br>原因：网址过长时调用dwz API，而该网站不支持HTTPS</p>
<p>修复方式有两种</p>
<p>允许长的网址<br>自己寻找可以缩短网址的API，进行替换<br>本文采用的是第一种，在trans_weixin.js 修改d函数即可</p>
<p>d = function () {<br>        s.attr(“data-url”) != r &amp;&amp; (u.html(“\u6b63\u5728\u52a0\u8f7d”), r.length &gt; 200 ?<br>        /<em>p(r, function (e) {<br>                h(e, !0)<br>            }) </em>/<br>         h(r):<br>         h(r))<br>    },<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>d = function () {<br>        s.attr(“data-url”) != r &amp;&amp; (u.html(“\u6b63\u5728\u52a0\u8f7d”), r.length &gt; 200 ?<br>        /<em>p(r, function (e) {<br>                h(e, !0)<br>            }) </em>/<br>         h(r):<br>         h(r))<br>    },</p>
<p>写在最后<br>OK，快去试试效果吧~</p>
<p>如果有不清楚的地方，欢迎留言。</p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[Hello World]]></title>
      <url>/2018/02/08/hello-world/</url>
      <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on [GitHub]<a id="more"></a>(<a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">https://github.com/hexojs/hexo/issues</a>).</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>
]]></content>
      
        <categories>
            
            <category> Python </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Python </tag>
            
            <tag> Django </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[使用Nginx过滤网络爬虫]]></title>
      <url>/2018/02/07/1/</url>
      <content type="html"><![CDATA[<p>现在的网络爬虫越来越多，有很多爬虫都是初学者写的，和搜索引擎的爬虫不一样，他们不懂如何控制速度，结果往往大量消耗服务器资源，导致带宽白白浪费了。<br><a id="more"></a><br>其实Nginx可以非常容易地根据User-Agent过滤请求，我们只需要在需要URL入口位置通过一个简单的正则表达式就可以过滤不符合要求的爬虫请求：</p>
<pre><code>...
location / {
    if ($http_user_agent ~* &quot;python|curl|java|wget|httpclient|okhttp&quot;) {
        return 503;
    }
    # 正常处理
    ...
}
...
</code></pre><p>变量$http_user_agent是一个可以直接在location中引用的Nginx变量。~*表示不区分大小写的正则匹配，通过python就可以过滤掉80%的Python爬虫。</p>
]]></content>
      
        
    </entry>
    
  
  
</search>
